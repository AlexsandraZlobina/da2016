---
title: "lab4"
output: html_document
---
##Лабораторная работа 4

#Загрузка данных о котах
```{r}
library(MASS) 
data(cats)
summary(cats)
```
У нас 47 кошек и 97 котов. 
Средний вес сердца
```{r}
mean(cats$Hwt)
```
Cреднеквадратичное отклонение
```{r}
sd(cats$Hwt)
```
Lисперсиz
```{r}
var(cats$Hwt)
```

рассчитайте параметры a и s. Округлите до разумного числа знаков
```{r}
a=round(mean(cats$Hwt)**2/var(cats$Hwt),3)
s=round(var(cats$Hwt)/mean(cats$Hwt),3)
a
s
```

Напишите функцию для расчёта параметров a и s через дисперсию и среднее для передаваемого вектора чисел. Функция должна зазываться my.gamma и возвращать рассчитанные параметры в виде именованного вектора.
```{r}
 my.gamma <- function(x)
{
   a = round(mean(x)**2/var(x), 3)
   s = round(var(x)/mean(x), 3)
   return(c(a,s))
}
```

```{r}
my.gamma(cats$Hwt)
```
Результаты идентичны

Постройте гистограмму весов. Добавьте на гистограмму кривую плотности вероятности при помощи функций curve и dgamma, указав ранее найденные параметры формы и масштаба.

```{r}
hist(cats$Hwt, main = "Гистограмма кошачьих весов", xlab = "Вес сердца в граммах", prob=TRUE,breaks = 20)
curve(dgamma(x, shape = a, scale = s), from = 0, to = 25,add=TRUE)
```

Получите параметры a и s отдельно для котов и кошек, использовав функцию my.gamma.
```{r}
Catboys = subset(cats, cats$Sex == "F")
Catgirls = subset(cats, cats$Sex == "M")
asCatgirls = my.gamma(Catgirls$Hwt)
asCatboys = my.gamma(Catboys$Hwt)
```
Постройте полученные функции распределения на одном графике, используя curve и dgamma.

```{r}
hist(Catboys$Hwt, main = "Гистограмма веса сердец котов", xlab = "Вес сердца в граммах", prob=TRUE,breaks = 20)
curve(dgamma(x, shape = asCatboys[1], scale = asCatboys[2]), from = 0, to = 25,add=TRUE)

```
```{r}
hist(Catgirls$Hwt, main = "Гистограмма веса сердец кошек", xlab = "Вес сердца в граммах", prob=TRUE,breaks = 20)
curve(dgamma(x, shape = asCatgirls[1], scale = asCatgirls[2]), from = 0, to = 25,add=TRUE)
```

Случайным образом разделите данные на две группы одного размера равного количеству котов и кошек соответственно. Получите гамма-параметры для обеих групп. Повторите эксперимент несколько раз. Найдите среднюю разницу между результатами групп.

```{r}
CM1 = sample(cats$Hwt, nrow(Catboys))
CM2 = sample(cats$Hwt, nrow(Catgirls))  
asCM1 = my.gamma(CM1)
asCM2 = my.gamma(CM2)
CM3 = sample(cats$Hwt, nrow(Catboys))
CM4 = sample(cats$Hwt, nrow(Catgirls)) 
asCM3 = my.gamma(CM3)
asCM4 = my.gamma(CM4)
CM5 = sample(cats$Hwt, nrow(Catboys))
CM6 = sample(cats$Hwt, nrow(Catgirls))  
asCM5 = my.gamma(CM5)
asCM6 = my.gamma(CM6)
CM7 = sample(cats$Hwt, nrow(Catboys))
CM8 = sample(cats$Hwt, nrow(Catgirls)) 
asCM7 = my.gamma(CM7)
asCM8 = my.gamma(CM8)
df=data.frame(asCM1,asCM2,asCM3,asCM4,asCM5,asCM6,asCM7,asCM8,row.names= c("a","s"))
df

```
```{r}
sum(a-asCM1[1], a-asCM3[1],a-asCM5[1],a-asCM7[1])/4
sum(a-asCM2[1], a-asCM4[1],a-asCM6[1],a-asCM8[1])/4
sum(s-asCM1[2], s-asCM3[2],s-asCM5[2],s-asCM7[2])/4
sum(s-asCM2[2], s-asCM4[2],s-asCM6[2],s-asCM8[2])/4
```














